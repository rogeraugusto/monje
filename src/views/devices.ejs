<!DOCTYPE HTML>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8">

		<title>Monje | Devices</title>
		
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link href="css/font-awesome.min.css" rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="css/loading.css">
		<link rel="stylesheet" href="css/style.css">

		<meta name="HandheldFriendly" content="true">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width, user-scalable=no">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	    <meta name="author" content="Roger Moraes">
	    
	    <meta name="theme-color" content="#ddd">
	    <meta name="msapplication-navbutton-color" content="#ddd">
	    <meta name="apple-mobile-web-app-capable" content="yes">
	    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	    <meta name="application-name" content="Monje">
	    <meta name="msapplication-TileColor" content="#FFFFFF">

	</head>

	<body>

		<div class="container">
			<div class="row">
		        <div class="col-md-10 col-md-offset-1">
		            <div class="panel-card">
		                <div class="card">
		                    <div class="card-body">
		                    	<% 	if (user) { %>
		                        		<div class="name">Hello <%= user.name %> 
		                        			<a href="/" class="btn btn-xs btn-danger btnLogout">Logout</a>
		                        		</div>
		                        <% 	} %>
		                    </div>
		                </div>
		            </div>
		        </div>
			</div>
    		<div class="row">
        		<div class="col-md-10 col-md-offset-1">
            		<div class="panel panel-default panel-table">
	              		<div class="panel-heading">
		                	<div class="row">
		                  		<div class="col-xs-8">
		                    		<h3 class="panel-title">My devices</h3>
		                  		</div>
		                  		<div class="col-xs-4">
									<a href="#" class="btn btn-xs btn-info btnAddDevice" data-toggle="modal" data-target="#modalDevice">Add Device</a>	
		                  		</div>	
		                	</div>
		              	</div>
		              	<div class="panel-body">
							<div class="table-responsive">	              	
			                	<table id="tableDevices" class="table table-striped table-bordered table-list">
			                  		<thead>
			                    		<tr>
			                        		<th width="50%">Title</th>
			                        		<th style="text-align: center;" width="20%">MAC</th>
			                        		<th style="text-align: center;" width="20%">Created At</th>
			                        		<th style="text-align: center;" width="10%">Action</th>
			                    		</tr> 
			                  		</thead>
			                  		<tbody>
			                        </tbody>
			                	</table>
			                </div>
		  	            </div>
            		</div>
				</div>
			</div>	
		</div>

		<div class="modal fade" id="modalDevice" tabindex="-1" role="dialog">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-body">
		        <p>Register a new device</p>
        		<% if (typeof deviceInfo == 'object' && deviceInfo) { %>
					<ul class="list-unstyled multilevels">
			            <li>Device info</li>
			            <li>
			                <ul>
								<% deviceInfo.forEach(data => { %>
									<li><a><%= data.key %> : <%= data.value %></a></li>
								<% }) %>  
			                </ul>
			            </li>
			        </ul>
		        <% } %>
                <div class="form-group">
                    <input class="form-control" placeholder="Simple name to identify" id="edDeviceDesc" name="edDeviceDesc" type="text">
                </div>
                <div id="erroCadDevice" style="margin-top: 5px;"></div>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-primary" id="btnSave" onclick="app.saveDevice()">Save changes</button>
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		      </div>
		    </div>
		  </div>
		</div>
	</body>

	<script src="js/jquery-3.3.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/loading.js"></script>
	<script src="js/app.js"></script>

 	<script>
		$(document).ready(() => {
			let devicesData = <%- JSON.stringify(devices) %>;
			let token = <%- JSON.stringify(token) %>;
			app.init(token);
			app.loadDevicesTable(devicesData);
		});
	</script>
</html>

